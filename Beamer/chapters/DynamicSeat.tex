% !TeX root = ./main.tex

\section{Dynamic Seat Assignment}
    \frame{\sectionpage}

    \begin{frame}{Assign-to-seat Rules}
        \begin{itemize}
          \item When the supply of one arriving group is enough, we will accept the group directly.
          \item When the supply of one arriving group is 0, the demand can be satisfied by only one larger-size supply.
          \item When one group is accepted to occupy the larger-size seats, the rest empty seat(s) can be reserved for future demand.
      \end{itemize}
      The difference of expected served people between acceptance and rejection on group $i$ occupying $(j+s)$-size seats: $d(i,j) = i + (j-i-1)P(D_{j-i-1} \geq x_{j-i-1}+1) - j P(D_{j} \geq x_{j}), j >i$.

      Find $d(i,j^{*}) = \max_{j} d(i,j)$, if $d(i,j^{*}) > 0$, accept group type $i$ in $j^{*}+s$-size seats; otherwise, reject it.
      \end{frame}

    \begin{frame}{Dynamic Seat Assignment for Each Group Arrival}
        \begin{description}
          \item[Step 1.] Obtain the set of patterns, $\mathbf{P} = \{P_1,\ldots,P_{N}\}$, from the feasible seat planning algorithm. The corresponding aggregated supply is $\mathbf{X} = [x_{1}, \ldots, x_{M}]$.
          \item[Step 2.] For the arrival group type $i$ at period $T{'}$, find the first $k \in [N]$ such that $i \in P_k$. Accept the group, update $P_{k} = P_{k}/(i)$ and $x_{i} = x_{i} -1$. Go to step 4.
          \item[Step 3.] If $i \notin P_k, \forall k \in [N]$, find $d(i,j^{*})$. If $d(i,j^{*})>0$, find the first $k \in [N]$ such that $j^{*} \in P_k$. Accept group type $i$ and update $P_{k} = P_{k}/(j^{*})$, $x_{j^{*}} = x_{j^{*}} -1$. Then update $x_{j-i-1} = x_{j-i-1} + 1$ and $P_{k}= P_{k} \cup (j^{*}-i-1)$ when $j^{*}-i-1 > 0$. If $d(i,j^{*}) \leq 0$, reject group type $i$.
          \item[Step 4.] If $T{'} \leq T$, move to next period, set $T{'} = T{'}+1$, go to step 2. Otherwise, terminate this algorithm.
        \end{description}
      \end{frame}
      
      \begin{frame}{Dynamic Seat Assignment after All Group Arrivals}
        Relax all rows to one row with the same capacity by $L = \sum_{j=1}^{N} L_j$.
        
        Deterministic problem is: $\{\max \sum_{i=1}^{M} (n_i- s) x_{i}: x_{i} \leq d_{i}, i \in [M], \sum_{i=1}^{M} n_{i} x_{i} \leq L, x_{i} \in \mathbb{Z}_{+}\}$.
        
        The optimal solution can be easily obtained. 

        The gap between the relaxed deterministic problem and original deterministic problem is zero for most cases. 

        Thus, we use DP to make the decision.
        $$V_{t}(L) = \mathbb{E}_{i \sim p} [\max_{u \in \{0,1\}} \{ {[V_{t+1}(L-n_i u)+ i u]}\}], L \geq 0$$ 
        $$V_{T+1}(x) =0, \forall x.$$
        

      \end{frame}
      